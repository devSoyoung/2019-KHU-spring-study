IoC/DI, AOP, PSA <=> 객체 지향

`각 기술을 적용하여 프로그래밍하면 객체 지향 프로그래밍을 할 수 있다.`

`객체 지향 프로그래밍의 정석을 따르면 모두 구현된다.`

# 1. 제어의 역전(IoC) / 의존관계 주입(DI)

왜 두 개의 오브젝트를 분리해서 만들고, 인터페이스를 두고 느슨하게 연결한 뒤, 실제 사용할 대상은 DI를 통해 외부에서 지정하는 것일까?
(= 이렇게 DI 방식으로 하는 것이 그렇지 않은 경우, 즉 직접 자신이 사용할 오브젝트를 new 키워드로 생성해서 사용하는 강한 결합을 쓰는 방법보다 나은 점은 무엇일까?)

=> 유연한 확장이 가능하게 하기 위해서이다.
=> DI는 *개방 폐쇄 원칙(OCP)이라는 객체지향 설계 원칙으로 잘 설명될 수 있다. 

객체로의 사용보다는 인터페이스를 통한 구현이 더 재사용이 편리하다.


*개방 폐쇠 원칙 = 확장에는 열려있고, 변경에는 닫혀있다.

### DI 활용 방법

#### 핵심기능의 변경
[전략 패턴](https://gmlwjd9405.github.io/2018/07/06/strategy-pattern.html) 그 자체이다.

핵심 기능 A에서 인터페이스(B)를 통해 의존이 생기는 대상을 빼내고 이를 인터페이스를 구현할 대상들(B1,B2,B3)에게 위임하는 방식. 
<img src="https://gmlwjd9405.github.io/images/design-pattern-strategy/strategy-pattern.png">

#### 핵심기능의 동적인 변경

DI를 런타임 중에 동적으로 변경하는 방식이다.

1) DAO가 여러 개의 Datasouce에 의존하는 경우.
2) 각 user의 등급마다 다른 DB를 사용하게 할 경우.

이 부분은 프록시 부분에서 더 나옵니다.

#### 부가기능의 추가

[데코레이터 패턴](https://gmlwjd9405.github.io/2018/07/09/decorator-pattern.html)을 사용하기 편하다.

기본 기능과 부가 기능을 나누어 따로 구현해내는 방식.

#### 인터페이스의 변경

[어댑터 패턴](https://limkydev.tistory.com/78)을 사용하기 편리하다.

A가 B라는 Interface를 쓰고 있었는데 부가적으로 C를 사용하고 싶다면, B의 내부에서 C를 호출하여 A에 코드의 변경없이 사용하는 방식.

PSA에서 다시 한 번 더 나옵니다.

#### 프록시

[프록시 패턴](https://limkydev.tistory.com/79)를 사용하기 편리하다.

프록시 = 대변인
<img src="https://t1.daumcdn.net/cfile/tistory/99CB0A33599FE63613">

원하는 것을 얻기 위해 직접 호출하는 것이 아니라 대신 호출해줄 수 있는 대상을 부르는 방식.

1) 서비스의 LOADING을 부여하고 싶은 경우
2) 원격 오브젝트를 호출할 때 마치 로컬에 존재하는 오브젝트처럼 사용할 수 있게 해주는 원격 프록시를 저굥하려고 할 때도 프록시가 필요하다.

#### 템플릿과 콜백

[탬플릿 콜백 패턴](https://limkydev.tistory.com/85)이 간편하다.

템플릿을 구현해놓으면 이를 호출하는 클라이언트에서 해당 부분에 내용을 추가할 수 있도록 하는 방식.

20여 가지의 템플릿/콜백을 지원하는 spring의 기능이 존재한다.
#### 싱글톤과 오브젝트 스코프

[싱글톤 패턴](https://gmlwjd9405.github.io/2018/07/06/singleton-pattern.html)사용을 권장한다.

전역 변수 없이 하나의 오브젝트에 참조할 수 있도록 하는 방식.

spring의 기본 설정은 싱글톤이지만, 오브젝트의 생명주기를 자유롭게 제어할 수 있다.

#### 테스트

spring은 각 각의 오브젝트의 고립을 만들어 테스트를 용이하게 한다.

테스트 코드 안에서 수동으로 목 오브젝트를 주입할 수 있다.


#### Spring은 디자인 패턴에 매우 적합한 DI를 제공하는 Framework이다.

# 2. 관점 지향 프로그래밍(AOP)

AOP와 OOP는 독립적인 것이 아니다.
OOP는 프로그램의 기술적인 난해함과 논리적인 요구사항을 한꺼번에 다루는 것에는 한계가 있다.
AOP는 이러한 OOP를 돕는 보조적인 기술이다.

스프링의 목적인, POJO만으로 엔터프라이즈 애플리케이션을 개발하면서도 엔터프라이즈 서비스를 선언적으로 제공하는 데 반드시 필요한 것이 바로 이 AOP 기술이다.


### AOP의 적용 기법

두 가지 방식이 존재한다. 

#### 첫 번째는 스프링과 같이 다이내믹 프록시를 사용하는 방법이다.

데코레이터 패턴을 이용하는 방식.

#### 두 번째는 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법이다.

AspectJ(AspectWerkz것도 있음.)라는 유명한 오픈소스 AOP툴이다.

[추가 정보](http://blog.naver.com/PostView.nhn?blogId=dilector&logNo=221364047262&parentCategoryNo=&categoryNo=33&viewDate=&isShowPopularPosts=true&from=search)

### AOP의 적용 단계

너무 남발해서 사용하다 보면 다른 개발자가 만든 코드가 예상하지 않은 방식으로 돌아가는 등의 혼란을 초래할 수 있다.

#### 1단계 : 미리 준비된 AOP 이용
Spring에서 제공하는 AOP를 사용하는 것부터 시작하자.

[추가 정보](https://flowarc.tistory.com/entry/Spring-AOP-Aspect-Oriented-Programming)

#### 2단계 : 전달팀을 통한 정책 AOP 적용
전체 프로젝트에서 개인이 직적 AOP를 적용하는 것은 힘들다.

소수의 AOP 담당자가 직접 구현해주는 것에 따라 이것을 모니터링해보고 분석해보는 것이 좋다.

#### 3단계 : AOP의 자유로운 이용
이전 단계를 통해 AOP와 많이 친숙해졌다면, 이를 활용하여 개발해보자.

하지만 개발 팀원들과 충분히 얘기하며 해야 이를 효율적으로 활용할 수 있다.

# 3. 포터블 서비스 추상화 (PSA)

Spring은 각종 API 기술을 갖고 있고 이를 쉽게 이용할 수 있다.
(EX. JavaEE, OXM, JavaMail, 등)

또한, 직접 서비스 추상화를 수행할 수도 있다.
